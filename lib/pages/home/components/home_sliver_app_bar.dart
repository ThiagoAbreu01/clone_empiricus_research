import 'package:clone_empiricus_research/app/core/ui/extensions/theme_extension.dart';import 'package:flutter/material.dart';class HomeSliverAppBar extends StatefulWidget {  final double expandedHeight;  const HomeSliverAppBar({super.key, required this.expandedHeight});  @override  State<HomeSliverAppBar> createState() => _HomeSliverAppBarState();}class _HomeSliverAppBarState extends State<HomeSliverAppBar> with SingleTickerProviderStateMixin {  late AnimationController _controller;  late Animation<double> _animation;  int _current = 0;  final List<Map<String, String>> _newsItems = [    {      'image': 'assets/images/news_money_times_1.png',      'title': 'Money Times',      'description': 'Embraer (EMBJ3) voou alto em 2025 segundo BTG Pactual',    },    {      'image': 'assets/images/news_money_times_2.png',      'title': 'Faça seu cadastro',      'description': 'Invest: Especial sobre fundos e estratégias para pequenos investidores — ideias práticas para diversificar a carteira',    },  ];  @override  void initState() {    super.initState();    _controller = AnimationController(vsync: this, duration: const Duration(seconds: 6));    _animation = CurvedAnimation(parent: _controller, curve: Curves.linear);    _controller.addStatusListener((status) {      if (status == AnimationStatus.completed) {        setState(() {          _current = (_current + 1) % _newsItems.length;        });        _controller.reset();        _controller.forward();      }    });    _controller.forward();  }  @override  void dispose() {    _controller.dispose();    super.dispose();  }  @override  Widget build(BuildContext context) {    final expandedHeight = widget.expandedHeight;    return SliverAppBar(      expandedHeight: expandedHeight,      pinned: true,      elevation: 0,      backgroundColor: const Color(0xFF2A2A2A),      leading: IconButton(        icon: const Icon(Icons.person, color: Colors.white),        onPressed: () {},      ),      actions: [        IconButton(          icon: const Icon(Icons.help_outline, color: Colors.white),          onPressed: () {},        ),      ],      flexibleSpace: LayoutBuilder(        builder: (context, constraints) {          final scrollProgress = ((expandedHeight - constraints.maxHeight) /                  (expandedHeight - kToolbarHeight))              .clamp(0.0, 1.0);          final visibleOpacity = (0.7 - scrollProgress).clamp(0.0, 1.0);          final item = _newsItems[_current];          return Stack(            fit: StackFit.expand,            children: [              Opacity(                opacity: visibleOpacity,                child: Image.asset(                  item['image']!,                  fit: BoxFit.cover,                ),              ),              Container(color: Colors.black.withOpacity(0.25 * visibleOpacity)),              Positioned(                left: 16,                right: 16,                bottom: 10,                child: Opacity(                  opacity: visibleOpacity,                  child: Column(                    crossAxisAlignment: CrossAxisAlignment.start,                    children: [                      Container(                        padding: const EdgeInsets.symmetric(horizontal: 10, vertical: 6),                        decoration: BoxDecoration(                          color: context.secondaryColor,                          borderRadius: BorderRadius.circular(50),                        ),                        child: Text(                          item['title']!,                          style: TextStyle(color: Colors.white, fontSize: 12, fontWeight: FontWeight.w700),                        ),                      ),                      const SizedBox(height: 8),                      Container(                        width: double.infinity,                        padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 8),                        decoration: BoxDecoration(                          borderRadius: BorderRadius.circular(6),                        ),                        child: Column(                          crossAxisAlignment: CrossAxisAlignment.start,                          children: [                            Text.rich(                              TextSpan(                                children: [                                  TextSpan(                                    text: item['description'],                                    style: TextStyle(color: Colors.white, fontSize: 16, fontWeight: FontWeight.w600),                                  ),                                   TextSpan(                                    text: ' Leia mais',                                    style: TextStyle(color: context.secondaryColor, fontWeight: FontWeight.w700),                                  ),                                ],                              ),                              maxLines: 3,                              overflow: TextOverflow.ellipsis,                            ),                            const SizedBox(height: 8),                            AnimatedBuilder(                              animation: _animation,                              builder: (context, child) {                                return ClipRRect(                                  borderRadius: BorderRadius.circular(4),                                  child: LinearProgressIndicator(                                    value: _animation.value,                                    minHeight: 5,                                    backgroundColor: Colors.grey,                                    color: Colors.white,                                  ),                                );                              },                            ),                          ],                        ),                      ),                    ],                  ),                ),              ),            ],          );        },      ),    );  }}